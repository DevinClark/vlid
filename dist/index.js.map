{"version":3,"sources":["lang/en.js","i18n.js","validate.js","vBase.js","vArray.js","vBoolean.js","vDate.js","vNumber.js","vObject.js","vString.js","index.js"],"names":["module","exports","ARRAY_BASE","ARRAY_RULE_MIN","ARRAY_RULE_MAX","BOOLEAN_BASE","DATE_BASE","DATE_RULE_MIN","DATE_RULE_MAX","DATE_RULE_ISO","GENERIC_OR","GENERIC_ERROR","GENERIC_ERROR_MULTIPLE","GENERIC_REQUIRED","NUMBER_BASE","NUMBER_RULE_MIN","NUMBER_RULE_MAX","OBJECT_BASE","STRING_BASE","STRING_RULE_ALPHANUM","STRING_RULE_EMAIL","STRING_RULE_MIN","STRING_RULE_MAX","STRING_RULE_REGEX","STRING_RULE_URL","lang","require","t","key","args","i18nString","undefined","Error","format","msg","fields","reduce","currentValue","currentIndex","replace","validate","any","data","opts","results","validateSync","Object","assign","_runAsync","Promise","all","map","r","resolve","then","formatResults","result","isValid","err","message","reject","errors","castData","_default","_allow","isAllowed","Array","isArray","includes","formatData","schema","some","filter","length","acc","val","concat","e","join","hasPromises","_rules","rule","ruleData","rawData","run","_doCast","_casts","forEach","cb","every","constructor","_cast","_base","allow","value","cast","on","turnOn","push","default","required","v","vBase","_schema","items","min","max","index","casted","toLowerCase","isoDateRegExp","RegExp","isISODate","str","test","isValidDate","d","Date","isFinite","castToDate","input","timestamp","parse","isNaN","iso","Number","isObject","prototype","toString","call","shouldCast","dt","isPlainObject","keys","emailRegex","String","alphanum","regex","email","parts","split","part","len","pattern","url","vArray","vBoolean","vDate","vNumber","vObject","vString","array","boolean","date","number","object","obj","string"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["module.exports = {\n  ARRAY_BASE: 'Must be an array',\n  ARRAY_RULE_MIN: 'Number of array items must be at least $1',\n  ARRAY_RULE_MAX: 'Number of array items must be no greater than $1',\n  BOOLEAN_BASE: 'Must be a boolean',\n  DATE_BASE: 'Must be a date',\n  DATE_RULE_MIN: 'Date must be after $1',\n  DATE_RULE_MAX: 'Date must be before $1',\n  DATE_RULE_ISO: 'Date must be in ISO-8601 format',\n  GENERIC_OR: ' OR ',\n  GENERIC_ERROR: 'Failed validation',\n  GENERIC_ERROR_MULTIPLE: 'Failed one or more validations',\n  GENERIC_REQUIRED: 'Is required and was not supplied',\n  NUMBER_BASE: 'Must be a number',\n  NUMBER_RULE_MIN: 'Must be larger than or equal to $1',\n  NUMBER_RULE_MAX: 'Must be less than or equal to $1',\n  OBJECT_BASE: 'Must be an object',\n  STRING_BASE: 'Must be a string',\n  STRING_RULE_ALPHANUM: 'Must be an alphanumeric string',\n  STRING_RULE_EMAIL: 'Must be an email address',\n  STRING_RULE_MIN: 'Must be longer than or equal to $1 characters',\n  STRING_RULE_MAX: 'Must be shorter than or equal to $1 characters',\n  STRING_RULE_REGEX: 'Failed regex pattern $1',\n  STRING_RULE_URL: 'Must be a URL',\n};\n","const lang = require('./lang/en');\n\nfunction t(key, ...args) {\n  let i18nString = lang[key];\n\n  if (i18nString === undefined) {\n    throw new Error('Missing translation for key ' + key);\n  }\n\n  return format(i18nString, args);\n}\n\nfunction format(msg, fields) {\n  return fields.reduce(function(msg, currentValue, currentIndex) {\n    return msg.replace('$' + (currentIndex + 1), currentValue);\n  }, msg);\n}\n\nmodule.exports = {\n  t,\n  format,\n};\n","const { t } = require('./i18n');\n\nfunction validate(any, data, opts = {}) {\n  let results = validateSync(any, data, Object.assign(opts, { _runAsync: true }));\n\n  return Promise.all(results.map(r => r instanceof Promise ? r : Promise.resolve(r)))\n    .then(results => formatResults(results, data))\n    .then(result => {\n      if (!result.isValid) {\n        let err = new Error(result.message);\n\n        Object.assign(err, result);\n\n        return Promise.reject(err);\n      }\n\n      return result;\n    });\n}\n\nfunction validateSync(any, data, opts = {}) {\n  let errors = [];\n  let isValid = true;\n  let message = '';\n  let results = [];\n  let castData = data === undefined ? any._default : data;\n\n  if (any._allow !== undefined) {\n    let isAllowed = Array.isArray(any._allow) ? any._allow.includes(castData) : any._allow === castData;\n\n    if (isAllowed) {\n      return {\n        data: castData,\n        errors: [],\n        isValid: true,\n      };\n    }\n  }\n\n  castData = formatData(any, castData, opts);\n\n  // Array = If ANY validation rules passes, the whole thing passes\n  if (Array.isArray(any)) {\n    results = any.map(schema => validateSync(schema, data));\n    isValid = results.some(r => r.isValid === true);\n\n    // Clear errors if isValid (at least one rule returned true)\n    errors = isValid ? [] : results.filter(r => r.errors.length > 0)\n      .map(r => r.errors)\n      .reduce((acc, val) => acc.concat(val), []);\n\n    // Return a single error\n    if (errors.length > 0) {\n      errors = [new Error(t('GENERIC_ERROR_MULTIPLE') + ': (' + errors.map(e => e.message).join(') ' + t('GENERIC_OR') + ' (') + ')')];\n      message = errors[0].message;\n    }\n\n    return {\n      data: castData,\n      errors,\n      message,\n      isValid,\n    };\n  // Normal single validation\n  } else {\n    results = any._rules.map(rule => {\n      let ruleData = rule.rawData ? data : castData;\n      let msg =\n        typeof rule.message === 'function'\n        ? rule.message(ruleData, opts)\n        : rule.message;\n\n      return rule.run(ruleData) || new Error(msg);\n    });\n    let hasPromises = results.filter(r => r instanceof Promise).length > 0;\n\n    if (hasPromises && !opts._runAsync) {\n      throw new Error('Cannot return Promise futures from vlid.validateSync()');\n    }\n  }\n\n  return opts._runAsync ? results : formatResults(results, castData);\n}\n\nfunction formatData(any, data, opts) {\n  let castData = data === undefined ? any._default : data;\n\n  // Cast value if specified (strict by default)\n  if (any._doCast || opts._doCast) {\n    any._casts.forEach(cb => castData = cb(castData));\n  }\n\n  return castData;\n}\n\n/**\n * Format array of results into a return object\n */\nfunction formatResults(results, data) {\n  let message = '';\n  let errors = results.filter(r => r instanceof Error);\n  let isValid = results.every(r => r === true);\n\n  if (errors.length > 0) {\n    message = errors.reduce((acc, err) => acc.concat(err), [])\n      .filter(err => err)\n      .map(err => err.message)\n      .join(', ');\n  }\n\n  return {\n    data,\n    errors,\n    message,\n    isValid,\n  };\n}\n\nmodule.exports = { validate, validateSync };\n","const { t } = require('./i18n');\nconst validate = require('./validate');\nconst GENERIC_ERROR = t('GENERIC_ERROR');\n\nmodule.exports = class vBase {\n  constructor() {\n    this._allow;\n    this._default;\n    this._rules = [];\n    this._casts = [];\n    this._doCast = false;\n\n    this._cast(); // Always run casting rules\n    this._base(); // Always run base validation rule for type\n  }\n\n  // These should be overridden by inheriting classes\n  _base() {}\n  _cast() {}\n\n  allow(value) {\n    this._allow = value;\n    return this;\n  }\n\n  cast(on, turnOn = true) {\n    if (typeof on === 'function') {\n      this._casts.push(on);\n\n      if (this._doCast === false) {\n        this._doCast = turnOn;\n      }\n\n      return this;\n    }\n\n    this._doCast = on === false ? false : true;\n    return this;\n  }\n\n  default(value) {\n    this._default = value;\n    return this.allow(value); // always allow the default value by default\n  }\n\n  required(err = null) {\n    return this.rule(v => v !== undefined && v !== null && v !== '', err || t('GENERIC_REQUIRED'));\n  }\n\n  rule(run, message = GENERIC_ERROR, opts = {}) {\n    if (typeof run !== 'function') {\n      throw new Error('rule() first argument must be a function. Recieved: ' + typeof run);\n    }\n\n    this._rules.push(Object.assign({ run, message }, opts));\n    return this;\n  }\n\n  validate(data, opts = {}) {\n    return validate.validate(this, data, opts);\n  }\n\n  validateSync(data, opts = {}) {\n    return validate.validateSync(this, data, opts);\n  }\n};\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\nconst validate = require('./validate');\n\nmodule.exports = class vArray extends vBase {\n  constructor() {\n    super();\n\n    this._schema;\n  }\n\n  _base() {\n    return this.rule(Array.isArray, value => t('ARRAY_BASE', value));\n  }\n\n  items(schema) {\n    this._schema = schema;\n    return this;\n  }\n\n  min(min, err = null) {\n    return this.rule(\n      value => value.length >= min,\n      value => err || t('ARRAY_RULE_MIN', min)\n    );\n  }\n\n  max(max, err = null) {\n    return this.rule(\n      value => value.length <= max,\n      value => err || t('ARRAY_RULE_MAX', max)\n    );\n  }\n\n  /**\n   * Override base validation\n   */\n  validateSync(data, opts = {}) {\n    let results = [];\n\n    results.push(validate.validateSync(this, data, opts)); // do base validation\n\n    if (!Array.isArray(data)) {\n      return {\n        data,\n        isValid: results[0].isValid,\n        errors: results[0].errors,\n      };\n    }\n\n    if (this._schema) {\n      data.forEach((value, index) => {\n        results.push(this._schema.validateSync(value));\n      });\n    }\n\n    let errors = results.filter(r => r.errors.length > 0)\n      .map(r => r.errors)\n      .reduce((acc, val) => acc.concat(val), []);\n    let isValid = results.every(r => r.isValid === true);\n\n    return {\n      data,\n      isValid,\n      errors,\n    };\n  }\n};\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\n\nmodule.exports = class vBoolean extends vBase {\n  _base() {\n    return this.rule(\n      value => typeof value === 'boolean',\n      value => t('BOOLEAN_BASE', value)\n    );\n  }\n\n  _cast() {\n    return this.cast(value => {\n      let casted = value;\n      let vt = typeof value;\n      let trueValues = [1, 'true', 't', 'on', 'yes'];\n      let falseValues = [0, 'false', 'f', 'off', 'no', ''];\n\n      // Lowercase strings for comparison\n      value = vt === 'string' ? value.toLowerCase() : value;\n\n      if (trueValues.includes(value)) {\n        casted = true;\n      }\n\n      if (falseValues.includes(value)) {\n        casted = false;\n      }\n\n      return casted;\n    }, false);\n  }\n};\n\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\n\nconst isoDateRegExp = new RegExp( /(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))/ );\n\nfunction isISODate( str ) {\n      return isoDateRegExp.test( str );\n}\n\nmodule.exports = class vDate extends vBase {\n  _base() {\n    return this.rule(isValidDate, value => t('DATE_BASE', value));\n  }\n\n  _cast() {\n    return this.cast(castToDate, false);\n  }\n\n  min(min, err = null) {\n    return this.rule(\n      value => value >= min,\n      err || t('DATE_RULE_MIN', min)\n    );\n  }\n\n  max(max, err = null) {\n    return this.rule(\n      value => value <= max,\n      err || t('DATE_RULE_MAX', max)\n    );\n  }\n\n  iso(err = null) {\n    this.cast(); // This rule requires casting (ISO-8601 date strings can be parsed)\n    this._base = () => {};\n\n    // This ISO rule has to be run on the raw input data, not the cast data\n    return this.rule(isISODate, err || t('DATE_RULE_ISO'), { rawData: true });\n  }\n};\n\nfunction isValidDate(d) {\n  return d instanceof Date && isFinite(d);\n}\n\nfunction castToDate(input) {\n  // If not a date, do some stuff\n  if (!(input instanceof Date)) {\n    let timestamp = Date.parse(input);\n\n    if (!isNaN(timestamp)) {\n      return new Date(timestamp);\n    }\n  }\n\n  return input;\n}\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\n\nmodule.exports = class vNumber extends vBase {\n  _base() {\n    return this.rule(\n      value => typeof value === 'number' && !Number.isNaN(value),\n      value => t('NUMBER_BASE', value)\n    );\n  }\n\n  _cast() {\n    return this.cast(Number, false);\n  }\n\n  min(min, err = null) {\n    return this.rule(\n      value => value >= min,\n      value => err || t('NUMBER_RULE_MIN', min)\n    );\n  }\n\n  max(max, err = null) {\n    return this.rule(\n      value => value <= max,\n      value => err || t('NUMBER_RULE_MAX', max)\n    );\n  }\n};\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\nconst validate = require('./validate');\n\nmodule.exports = class vObject extends vBase {\n  constructor(schema = {}) {\n    super();\n\n    this._schema = schema || {};\n  }\n\n  _base() {\n    return this.rule(isObject, value => t('OBJECT_BASE', value));\n  }\n\n  /**\n   * Override base validation\n   */\n  validateSync(data, opts = {}) {\n    let results = [];\n    let shouldCast = opts._doCast || this._doCast;\n\n    results.push(validate.validateSync(this, data, opts)); // do base validation\n\n    let dt = typeof data;\n    let isPlainObject = false;\n\n    if (dt === 'object') {\n      isPlainObject = Object.prototype.toString.call(data) === '[object Object]';\n    }\n\n    if (data && isPlainObject) {\n      Object.keys(this._schema).forEach(key => {\n        results.push(this._schema[key].validateSync(data[key], { key, _doCast: shouldCast }));\n      });\n    }\n\n    let errors = results.filter(r => r.errors.length > 0);\n    let isValid = results.every(r => r.isValid === true);\n\n    return {\n      data,\n      isValid,\n      errors,\n    };\n  }\n};\n\nfunction isObject(value) {\n  return (\n    typeof value === 'object'\n    && Object.prototype.toString.call(value) === '[object Object]'\n  );\n}\n","const { t } = require('./i18n');\nconst vBase = require('./vBase');\n\n/* @link https://github.com/manishsaraan/email-validator/blob/master/index.js */\nconst emailRegex = /^[-!#$%&'*+\\/0-9=?A-Z^_a-z{|}~](\\.?[-!#$%&'*+\\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\\.?[a-zA-Z0-9])*\\.[a-zA-Z](-?[a-zA-Z0-9])+$/;\n\nmodule.exports = class vString extends vBase {\n  _base() {\n    return this.rule(\n      value => typeof value === 'string',\n      value => t('STRING_BASE', value)\n    );\n  }\n\n  _cast() {\n    return this.cast(String, false);\n  }\n\n  alphanum() {\n    return this.regex(/^[a-zA-Z0-9]+$/, t('STRING_RULE_ALPHANUM'));\n  }\n\n  email(err) {\n    return this.rule(function(email) {\n      if (!email) return false;\n\n      if (email.length > 254) return false;\n\n      var valid = emailRegex.test(email);\n      if (!valid) return false;\n\n      // Further checking of some things regex can't handle\n      var parts = email.split('@');\n      if (parts[0].length > 64) return false;\n\n      var domainParts = parts[1].split('.');\n      if (\n        domainParts.some(function(part) {\n          return part.length > 63;\n        })\n      )\n        return false;\n\n      return true;\n    }, err || t('STRING_RULE_EMAIL'));\n  }\n\n  min(len, err = null) {\n    return this.rule(value => value.length >= len, err || t('STRING_RULE_MIN', len));\n  }\n\n  max(len, err = null) {\n    return this.rule(value => value.length <= len, err || t('STRING_RULE_MAX', len));\n  }\n\n  regex(pattern, err = null) {\n    return this.rule(value => pattern.test(value), err || t('STRING_RULE_REGEX', pattern));\n  }\n\n  url(str, err = null) {\n    return this.rule(function validURL(str) {\n      var pattern = new RegExp(\n        '^(https?:\\\\/\\\\/)?' + // protocol\n        '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name\n        '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n        '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*' + // port and path\n        '(\\\\?[;&a-z\\\\d%_.~+=-]*)?' + // query string\n          '(\\\\#[-a-z\\\\d_]*)?$',\n        'i'\n      ); // fragment locator\n      return !!pattern.test(str);\n    }, err || t('STRING_RULE_URL'));\n  }\n};\n","const vArray = require('./vArray');\nconst vBase = require('./vBase');\nconst vBoolean = require('./vBoolean');\nconst vDate = require('./vDate');\nconst vNumber = require('./vNumber');\nconst vObject = require('./vObject');\nconst vString = require('./vString');\nconst { validate, validateSync } = require('./validate');\n\nmodule.exports = {\n  any: () => new vBase(),\n  array: () => new vArray(),\n  boolean: () => new vBoolean(),\n  date: () => new vDate(),\n  number: () => new vNumber(),\n  object: (obj) => new vObject(obj),\n  string: () => new vString(),\n  validate(schema, data) {\n    return schema.validate ? schema.validate(data) : validate(schema, data);\n  },\n  validateSync(schema, data) {\n    return schema.validateSync ? schema.validateSync(data) : validateSync(schema, data);\n  },\n};\n"]}